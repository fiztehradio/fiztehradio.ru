function setNumberDivColor(e){e.text()>99?e.css("color","#FF0000"):e.text()>49?e.css("color","#F45743"):e.text()>24?e.css("color","#F2A232"):e.text()>14?e.css("color","#EDE63C"):e.text()>4?e.css("color","#5CAA4F"):e.text()>1?e.css("color","#638094"):e.css("color","#616161")}function changelistenersNumber(){var e=$("#website-listeners-number"),t=$("#youtube-listeners-number"),s=$("#vk-listeners-number");$.ajax({url:"php/icecast-listeners-number.php"}).done(function(r){console.log(r[0]),e.text(r[0].websiteListenersNumber),t.text(r[0].youtubeListenersNumber),s.text(r[0].vkListenersNumber),setNumberDivColor(e),setNumberDivColor(t),setNumberDivColor(s)})}var chart;$(document).ready(function(){changelistenersNumber(),chart=AmCharts.makeChart("stats-chart",{type:"stock",theme:"light",glueToTheEnd:!0,syncDataTimestamps:!0,gridAboveGraphs:!0,fontSize:12,dataDateFormat:"hh:mm:ss DD.MM.YYYY",dataSets:[{fieldMappings:[{fromField:"websiteListenersNumber",toField:"website"},{fromField:"youtubeListenersNumber",toField:"youtube"},{fromField:"vkListenersNumber",toField:"vk"}],categoryField:"timestamp",dataLoader:{url:"php/get_stats.php",format:"json",showCurtain:!1,showErrors:!0,numberFields:["timestamp","websiteListenersNumber","youtubeListenersNumber","vkListenersNumber"],postProcess:function(e,t,s){$.each(e,function(){this.timestamp*=1e3,this.totalListeners=parseInt(this.websiteListenersNumber)+parseInt(this.youtubeListenersNumber)+parseInt(this.vkListenersNumber)});var r=e[e.length-1],l={timestamp:(new Date).getTime(),websiteListenersNumber:r.websiteListenersNumber,youtubeListenersNumber:r.youtubeListenersNumber,vkListenersNumber:r.vkListenersNumber,totalListeners:r.totalListeners};return e.push(l),e},reload:2}}],panels:[{legend:{},stockGraphs:[{id:"graph1",valueField:"website",type:"line",title:"Website",useDataSetColors:!1,fillColor:"#00FF00",fillAlphas:.2,lineAlpha:1,lineThickness:3,lineColor:"#00B0FF",bullet:"round",bulletBorderAlpha:1,useLineColorForBulletBorder:!0,hideBulletsCount:50},{id:"graph2",valueField:"youtube",type:"line",title:"Youtube stream",useDataSetColors:!1,fillAlphas:.2,lineAlpha:1,lineThickness:3,lineColor:"#FF6D00",bullet:"round",bulletBorderAlpha:1,bulletColor:"#FFFFFF",useLineColorForBulletBorder:!0,hideBulletsCount:50},{id:"graph3",valueField:"vk",type:"line",title:"VK stream",useDataSetColors:!1,fillAlphas:.2,lineAlpha:1,lineThickness:3,lineColor:"#00E676",bullet:"round",bulletBorderAlpha:1,bulletColor:"#FFFFFF",useLineColorForBulletBorder:!0,hideBulletsCount:50},{id:"totalListeners",valueField:"totalListeners",lineAlpha:0}],zoomOutOnDataUpdate:!1}],categoryAxesSettings:{dashLength:5,minPeriod:"ss",maxSeries:-1},valueAxesSettings:{dashLength:5},chartScrollbarSettings:{graph:"graph1",graphType:"line",scrollbarHeight:100},chartCursorSettings:{valueBalloonsEnabled:!0},periodSelector:{periods:[{period:"hh",count:1,label:"1 час",selected:!0},{period:"hh",count:2,label:"2 часа"},{period:"hh",count:6,label:"6 часов"},{period:"hh",count:12,label:"12 часов"},{period:"hh",count:24,label:"24 часа"},{period:"MAX",label:"MAX"}]}})});